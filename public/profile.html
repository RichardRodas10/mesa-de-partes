<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil</title>
    <link rel="icon" href="./img/logo.ico">
    <link rel="preload" href="css/normalize.css" as="style">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Krub:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preload" href="css/main.css" as="style">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <span class="text-title">CJN</span>
            </div>
            <div class="header-center">
                <span class="mesa-partes-text">MESA DE PARTES VIRTUAL</span>
            </div>
            <div class="header-right">
                <div id="logout" class="logout" title="Cerrar sesión">
                    <i class="fa-solid fa-right-from-bracket fa-2xl" style="color: #1983a3;"></i>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="menu-item" onclick="window.location.href='procedure.html'">
                <span class="icon"><i class="fa-solid fa-house"></i></span>
                <span class="text"><strong>MIS TRÁMITES</strong></span>
            </div>
            <div class="menu-item" onclick="window.location.href='home.html'">
                <span class="icon"><i class="fa-solid fa-envelope"></i></span>
                <span class="text"><strong>INGRESAR SOLICITUD</strong></span>
            </div>
            <div class="menu-item active" onclick="window.location.href='profile.html'">
                <span class="icon"><i class="fa-solid fa-user-gear"></i></span>
                <span class="text"><strong>MI PERFIL</strong></span>
            </div>  
            <div class="contact-info">
                <p><strong>Central Telefónica: (01) 612-8230</strong></p>
                <p class="whatsapp"><strong>WhatsApp: 966 429 596</strong></p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="profile-main-container">
                <!-- Tabs -->
                <div class="profile-navigation-tabs">
                    <button class="profile-tab-btn active" onclick="showProfileTab('profile-data-tab')">
                        <i class="fa-solid fa-user"></i>
                        Perfil
                    </button>
                    <button class="profile-tab-btn" onclick="showProfileTab('password-change-tab')">
                        <i class="fa-solid fa-lock"></i>
                        Actualizar contraseña
                    </button>
                </div>

                <!-- Profile Tab Content -->
                <div id="profile-data-tab" class="profile-tab-content active">
                    <div class="profile-page-header">
                        <h1 class="profile-main-title">ACTUALIZAR PERFIL</h1>
                    </div>

                    <form class="profile-data-form">
                        <div class="profile-edit-toggle">
                            <button type="button" class="profile-edit-btn" onclick="toggleProfileEdit()">
                                <i class="fa-solid fa-pencil"></i>
                                Editar
                            </button>
                        </div>

                        <div class="profile-form-row">
                            <div class="profile-form-group">
                                <label>Apellidos y nombres</label>
                                <input type="text" class="profile-form-control" readonly>
                            </div>
                            <div class="profile-form-group">
                                <label>Documento Identidad</label>
                                <input type="text" class="profile-form-control" readonly>
                            </div>
                        </div>

                        <div class="profile-form-row profile-triple">
                            <div class="profile-form-group">
                                <label>Departamento</label>
                                <input type="text" class="profile-form-control profile-readonly-field style-select" id="departamento-input" readonly>
                                <select class="profile-form-control profile-editable-field" id="departamento" disabled>
                                    <option value="">Seleccione...</option>
                                </select>
                            </div>
                            <div class="profile-form-group">
                                <label>Provincia</label>
                                <input type="text" class="profile-form-control profile-readonly-field" id="provincia-input" readonly>
                                <select class="profile-form-control profile-editable-field" id="provincia" disabled>
                                    <option value="">Seleccione...</option>
                                </select>
                            </div>
                            <div class="profile-form-group">
                                <label>Distrito</label>
                                <input type="text" class="profile-form-control profile-readonly-field" id="distrito-input" readonly>
                                <select class="profile-form-control profile-editable-field" id="distrito" disabled>
                                    <option value="">Seleccione...</option>
                                </select>
                            </div>
                        </div>                                            

                        <div class="profile-form-row-email">
                            <div class="profile-form-group">
                                <label>Dirección/domicilio fiscal</label>
                                <input type="text" id="direccion-input" class="profile-form-control profile-editable-field" readonly>
                            </div>
                        </div>
                        
                        <div class="profile-form-row profile-triple">
                            <div class="profile-form-group">
                                <label>Celular</label>
                                <input type="text" id="celular-input" class="profile-form-control profile-editable-field" readonly>
                            </div>
                            <div class="profile-form-group">
                                <label>Correo Electrónico</label>
                                <input type="email" id="correo-input" class="profile-form-control" readonly>
                            </div>
                        </div>
                        
                        <div class="profile-form-actions">
                            <button type="button" class="profile-update-btn" onclick="updateUserProfile()" style="display: none;">
                                <i class="fa-solid fa-sync-alt"></i>
                                Actualizar datos
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Password Tab Content -->
                <div id="password-change-tab" class="profile-tab-content">
                    <div class="profile-page-header">
                        <h1 class="profile-main-title">ACTUALIZAR CONTRASEÑA</h1>
                        <p class="profile-page-subtitle">Cambia tu contraseña por una más segura</p>
                    </div>

                    <form class="profile-password-form">
                        <div class="profile-password-requirements">
                            <h4>Requisitos de la contraseña:</h4>
                            <ul>
                                <li>Mínimo 8 caracteres</li>
                                <li>Al menos una letra mayúscula</li>
                                <li>Al menos una letra minúscula</li>
                                <li>Al menos un número</li>
                                <li>Al menos un carácter especial (@, #, $, etc.)</li>
                            </ul>
                        </div>
                        
                        <div class="profile-form-group">
                            <label>Contraseña actual</label>
                            <input type="password" id="current-password" class="profile-form-control">
                        </div>
                        
                        <div class="profile-form-group">
                            <label>Nueva contraseña</label>
                            <input type="password" id="new-password" class="profile-form-control">
                        </div>
                        
                        <div class="profile-form-group">
                            <label>Confirmar nueva contraseña</label>
                            <input type="password" id="confirm-password" class="profile-form-control">
                        </div>                        

                        <div class="profile-form-actions">
                            <button type="button" class="profile-change-password-btn" onclick="changeUserPassword()">
                                <i class="fa-solid fa-key"></i>
                                Cambiar contraseña
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Éxito -->
    <div id="profileSuccessModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-icon"><i class="fa-solid fa-check-circle"></i></span>
                <h3>¡Éxito!</h3>
            </div>
            <div class="modal-body">
                <p id="profileSuccessMessage">Perfil actualizado correctamente.</p>
            </div>
            <div class="modal-actions">
                <button class="btn-accept" onclick="closeProfileModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal Cerrar Sesión -->
    <div id="logoutModal" class="modal">
        <div class="modal-content">
        <div class="modal-header">
            <span class="modal-icon"><i class="fa-solid fa-circle-info"></i></span>
            <h3>Cerrar sesión</h3>
        </div>
        <div class="modal-body">
            <p>Se cerrará tu sesión actual.</p>
            <p>¿Deseas continuar?</p>
        </div>
        <div class="modal-actions">
            <button id="logoutAccept" class="btn-accept">✓ Aceptar</button>
            <button id="logoutCancel" class="btn-cancel">✗ Cancelar</button>
        </div>
        </div>
    </div>
    
    <script src="./js/ubigeo.js"></script>
    <script type="module" src="./js/profile.js"></script>
    <script type="module" src="./js/session-guard.js"></script>
</body>
</html>